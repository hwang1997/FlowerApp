<!DOCTYPE html>
<html style="width: 100%">
<head>
    <meta charset="utf-8">
    <title>登录--河马后台管理系统 1.0</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="icon" href="../images/icon_logo.ico">
    <link rel="stylesheet" href="../layui/css/layui.css">
    <link rel="stylesheet" href="../css/index.css" media="all"/>

</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">

    <!--head文件-->
    <div class="layui-header">
        <div><a href="./home.html" class="layui-logo">河马花店后台管理系统</a></div>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <a href="javascript:;" class="seraph hideMenu layui-icon layui-icon-slider"
           style="width: 30px;font-size: 16px"></a>
        <ul class="layui-nav layui-layout-left" style="left: 260px">
            <li class="layui-nav-item" id="nowTime"></li>
        </ul>

        <ul class="layui-nav layui-layout-right" style="right: 50px">
            <li class="layui-nav-item">
                <a class="clearCache" style="margin-right: 20px"><i class="layui-icon layui-icon-delete"
                                                                    style="margin-right: 2px"></i>清除缓存<span
                        class="layui-badge-dot"></span></a>
            </li>
            <li class="layui-nav-item lockcms" pc>
                <a href="javascript:;"><i class="layui-icon layui-icon-password"
                                          style="margin-right: 2px"></i><cite>锁屏</cite></a>
            </li>
            <li class="layui-nav-item" style="padding-left: 10px" id="userInfo">
                <a href="javascript:;" style="padding-left: 5px">
                    <img src="../images/login_face.jpeg" class="layui-nav-img">
                    <span id="role" style="padding-right: 5px">系统管理员</span>
                </a>
                <dl class="layui-nav-child">
                    <dd><a data-url="updateUsers" data-title="修改密码" data-id="66" class="site-demo-active"
                           data-type="tabAdd"><i class="layui-icon layui-icon-edit"
                                                 style="margin-right: 2px"></i>修改密码</a></dd>
                    <dd><a href="javascript:;" class="showNotice"><i class="layui-icon layui-icon-speaker"
                                                                     style="margin-right: 2px"></i><cite>系统公告</cite><span
                            class="layui-badge-dot"></span></a></dd>
                    <dd>
                        <a class="functionSetting">
                            <span class="layui-icon layui-icon-set" style="margin-right: 2px"></span>功能设置
                        </a>
                    </dd>
                    <dd pc><a href="javascript:;" class="changeSkin"><i class="layui-icon">&#xe61b;</i><cite>更换皮肤</cite></a>
                    </dd>
                    <dd>
                        <a class="signOut">
                            <span class="layui-icon layui-icon-logout" style="margin-right: 2px"></span>安全退出
                        </a>
                    </dd>

                </dl>
            </li>

        </ul>
    </div>
    <!--左侧side文件-->

    <!--<div id="side"></div>-->
    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree" lay-filter="test">
                <li class="layui-nav-item layui-nav-itemed">
                    <a class="" href="javascript:;">用户管理</a>
                    <dl class="layui-nav-child site-demo-button">
                        <dd><a data-url="users" data-title="用户管理" data-id="10" class="site-demo-active"
                               data-type="tabAdd">用户列表</a></dd>
                        <dd><a data-url="addUsers" data-title="新增用户" data-id="11" class="site-demo-active"
                               data-type="tabAdd">新增用户</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a class="" href="javascript:;">商品管理</a>
                    <dl class="layui-nav-child site-demo-button">
                        <dd><a data-url="goods" data-title="商品管理" data-id="22" class="site-demo-active"
                               data-type="tabAdd">商品列表</a></dd>
                        <dd><a data-url="addGoods" data-title="新增商品" data-id="33" class="site-demo-active"
                               data-type="tabAdd">新增商品</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item"><a data-url="orders" data-title="订单管理" data-id="44" class="site-demo-active"
                                              data-type="tabAdd">订单管理</a></li>
                <li class="layui-nav-item"><a data-url="bus" data-title="购物车" data-id="55" class="site-demo-active"
                                              data-type="tabAdd">购物车</a></li>
            </ul>
        </div>
    </div>

    <div class="layui-body">
        <!-- 内容主体区域 -->
        <div class="layui-tab layui-tab-brief" lay-allowclose="true" lay-filter="demo" style="position: relative">
            <ul class="layui-tab-title">
                <li><i class="layui-icon layui-icon-home" style="margin-right: 2px"></i>首页</li>
            </ul>
            <ul class="rightmenu" style="display: none;position: absolute">
                <li data-type="closeall" class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-delete"></i>关闭所有
                </li>
            </ul>
            <div class="layui-tab-content" style="width: 100%;height: 100%">
                <div class="layui-tab-item layui-show firstPageImg">
                    <img src="../images/home_bg.jpg">
                </div>
            </div>
        </div>
    </div>

    <!--尾部文件-->
    <div class="layui-footer footer">
        <!-- 底部固定区域 -->
        by：wanghuan，1447081730@qq.com
    </div>
</div>
<script src="../layui/layui.all.js"></script>
<script src="../js/jquery-3.4.1.min.js"></script>
<script src="../js/cache.js"></script>
<script>
    var $ = layui.jquery;
    var element = layui.element;
    var layer = layui.layer;
    var active = {
        tabAdd: function (url, id, name) {
            //新增一个Tab项
            element.tabAdd('demo', {
                title: name //用于演示
                ,
                content: ('<iframe data-frameid="' + id + '" src="' + url + '.html" class="iframeId" frameborder="0" width="100%" height="700px"></iframe>')
                ,
                id: id //实际使用一般是规定好的id，这里以时间戳模拟下
            });
            CustomRightClick(id);
            FrameWH();

        },
        tabChange: function (id) {
            //切换到指定Tab项
            element.tabChange('demo', id);
        },
        tabDeleteAll: function (ids) {//删除所有
            $.each(ids, function (i, item) {
                element.tabDelete('demo', item);
            })
        }
    };

    $('.site-demo-active').on('click', function () {
        var dataid = $(this);
        if ($('.layui-tab-title li[lay-id]').length <= 0) {
            active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), dataid.attr("data-title"));
        } else {
            var isData = false;
            $.each($('.layui-tab-title li[lay-id]'), function () {
                if ($(this).attr('lay-id') == dataid.attr('data-id')) {
                    isData = true;
                }
            });
            if (isData == false) {
                active.tabAdd(dataid.attr('data-url'), dataid.attr('data-id'), dataid.attr('data-title'));
            }
        }
        active.tabChange(dataid.attr('data-id'));
    });

    function CustomRightClick(id) {
        $('.layui-tab-title li').on('contextmenu', function () {
            return false;
        });
        $('.layui-tab-title,.layui-tab-title li').click(function () {
            $('.rightmenu').hide();
        });
        //桌面点击右击
        $('.layui-tab-title ').on('contextmenu', function (e) {
            var popupmenu = $('.rightmenu');
            popupmenu.find('layui-tab-title').attr('data-id', id);//在右键菜单中的标签绑定id属性
            //判断右侧菜单的位置
            popupmenu.css({right: 40, top: 0}).show();//绝对定位
            return false;
        })
    }

    $(".rightmenu li").click(function () {
        if ($(this).attr("data-type") == "closeall") {
            var tabtitle = $(".layui-tab-title li");
            var ids = new Array();
            $.each(tabtitle, function (i) {
                ids[i] = $(this).attr("lay-id");
            });
            //如果关闭所有 ，即将所有的lay-id放进数组，执行tabDeleteAll
            active.tabDeleteAll(ids);
        }
        $('.rightmenu').hide(); //最后再隐藏右键菜单
    })

    function FrameWH() {
        var h = $(window).height();
        $("iframe").css("height", h + "px");
    }

    $(window).resize(function () {
        FrameWH();
    });

    //隐藏左侧导航
    var flag = 1;
    $(".hideMenu").click(function () {
        if (flag == 1) {
            if ($(".topLevelMenus li.layui-this a").data("url")) {
                layer.msg("此栏目状态下左侧菜单不可展开");  //主要为了避免左侧显示的内容与顶部菜单不匹配
                return false;
            }
            $(".layui-layout-admin").toggleClass("showMenu");
        }
    });

    var userId = localStorage.getItem('userId');
    //获取系统时间
    var newDate = '';
    var userName = localStorage.getItem('userName');
    getLangDate();

    //值小于10时，在前面补0
    function dateFilter(date) {
        if (date < 10) {
            return "0" + date;
        }
        return date;
    }

    function getLangDate() {
        var dateObj = new Date(); //表示当前系统时间的Date对象
        var year = dateObj.getFullYear(); //当前系统时间的完整年份值
        var month = dateObj.getMonth() + 1; //当前系统时间的月份值
        var date = dateObj.getDate(); //当前系统时间的月份中的日
        var day = dateObj.getDay(); //当前系统时间中的星期值
        var weeks = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
        var week = weeks[day]; //根据星期值，从数组中获取对应的星期字符串
        var hour = dateObj.getHours(); //当前系统时间的小时值
        var minute = dateObj.getMinutes(); //当前系统时间的分钟值
        var second = dateObj.getSeconds(); //当前系统时间的秒钟值
        var timeValue = "" + ((hour >= 12) ? (hour >= 18) ? "晚上" : "下午" : "上午"); //当前时间属于上午、晚上还是下午
        newDate = dateFilter(year) + "年" + dateFilter(month) + "月" + dateFilter(date) + "日 " + " " + dateFilter(hour) + ":" + dateFilter(minute) + ":" + dateFilter(second);
        document.getElementById("nowTime").innerHTML = "亲爱的 " + userName + "，" + timeValue + "好！ 当前时间为： " + newDate + "　" + week;
        setTimeout("getLangDate()", 1000);
    }

    //清除缓存
    $(".clearCache").click(function () {
        window.localStorage.clear();
        var index = layer.msg('清除缓存中，请稍候', {icon: 16, time: false, shade: 0.8});
        setTimeout(function () {
            layer.close(index);
            layer.msg("缓存清除成功！");
            location.reload();
        }, 1000);

    });


</script>

</body>


</html>